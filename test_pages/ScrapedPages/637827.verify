{"title":"Redirect stderr and stdout in Bash","commands":["yourcommand \u0026\u003efilename \u0026\u0026 ","do_something 2\u003e\u00261 | tee -a some_file \u0026\u0026 ","some_command \u003efile.log 2\u003e\u00261 \u0026\u0026 ","# Close STDOUT file descriptor\nexec 1\u003c\u0026-\n# Close STDERR FD\nexec 2\u003c\u0026-\n\n# Open STDOUT as $LOG_FILE file for read and write.\nexec 1\u003c\u003e$LOG_FILE\n\n# Redirect STDERR to STDOUT\nexec 2\u003e\u00261\n\necho \"This line will appear in $LOG_FILE, not \u0027on screen\u0027\" \u0026\u0026 exec 3\u003e\u00261 4\u003e\u00262 1\u003e \u003e(tee \u003e(logger -i -t \u0027my_script_tag\u0027) \u003e\u00263) 2\u003e \u003e(tee \u003e(logger -i -t \u0027my_script_tag\u0027) \u003e\u00264)\ntrap \u0027cleanup\u0027 INT QUIT TERM EXIT\n\n\nget_pids_of_ppid() {\n    local ppid\u003d\"$1\"\n\n    RETVAL\u003d\u0027\u0027\n    local pids\u003d`ps x -o pid,ppid | awk \"\\\\$2 \u003d\u003d \\\\\"$ppid\\\\\" { print \\\\$1 }\"`\n    RETVAL\u003d\"$pids\"\n}\n\n\n# Needed to kill processes running in background\ncleanup() {\n    local current_pid element\n    local pids\u003d( \"$$\" )\n\n    running_pids\u003d(\"${pids[@]}\")\n\n    while :; do\n        current_pid\u003d\"${running_pids[0]}\"\n        [ -z \"$current_pid\" ] \u0026\u0026 break\n\n        running_pids\u003d(\"${running_pids[@]:1}\")\n        get_pids_of_ppid $current_pid\n        local new_pids\u003d\"$RETVAL\"\n        [ -z \"$new_pids\" ] \u0026\u0026 continue\n\n        for element in $new_pids; do\n            running_pids+\u003d(\"$element\")\n            pids\u003d(\"$element\" \"${pids[@]}\")\n        done\n    done\n\n    kill ${pids[@]} 2\u003e/dev/null\n} \u0026\u0026 echo \"Will end up in STDOUT(terminal) and /var/log/messages\" \u0026\u0026 $ ./my_script\nWill end up in STDOUT(terminal) and /var/log/messages\n\n$ tail -n1 /var/log/messages\nSep 23 15:54:03 wks056 my_script_tag[11644]: Will end up in STDOUT(terminal) and /var/log/messages \u0026\u0026 ls -l /proc/self/fd/\nps xf \u0026\u0026 ","bash your_script.sh 1\u003efile.log 2\u003e\u00261 \u0026\u0026 "]}